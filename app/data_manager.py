from reportlab.lib.pagesizes import letter
from reportlab.pdfgen import canvas
from icalendar import Calendar, Event
from datetime import datetime
# for time zone UTC
from pytz import UTC
import csv
import os
import shutil


class DataManager:
    """This class is responsible for managing the extracted data, storing it, and retrieving it as necessary."""

    def export_contacts(self, extracted_data, data_dir):
        with open(os.path.join(data_dir, "contact.csv"), 'w', newline='') as file:
            writer = csv.writer(file, delimiter=',')
            writer.writerow(extracted_data[0])
            for contact in extracted_data[1]:
                writer.writerow(contact)

    def export_call_history(self, extracted_data, data_dir):
        with open(os.path.join(data_dir, "call_history.csv"), 'w', newline='') as file:
            writer = csv.writer(file, delimiter=',')
            writer.writerow(
                ["From", "To", "Name", "Type", "Start date", "Duration", "Location"])
            for contact in extracted_data:
                is_for_me, call_successful, name, location, call_time, call_duration, phone_number = contact
                if is_for_me == 0:
                    writer.writerow([phone_number, "me", name, "standard", call_time, call_duration, location])
                elif is_for_me == 1:
                    writer.writerow(["me", phone_number, name, "standard", call_time, call_duration, location])

    def export_web_history(self, extracted_data, data_dir):
        with open(os.path.join(data_dir, "web_history.csv"), 'w') as csvfile:
            writer = csv.DictWriter(csvfile, extracted_data.keys(), delimiter=',')
            writer.writeheader()
            writer.writerows(extracted_data)

    def export_sms(self, extracted_data, data_dir):
        # create a new folder messages
        if not (os.path.exists(os.path.join(data_dir, "messages"))):
            os.mkdir(os.path.join(data_dir, "messages"))
        # group the message by phone number
        grouped_data = {}
        for data in extracted_data:
            id, display_name, datetime, is_for_me, phone_number, message = data
            if phone_number not in grouped_data:
                grouped_data[phone_number] = []
            grouped_data[phone_number].append((display_name, datetime, is_for_me, message))

        # for each phone number, we will create a new pdf doc
        for phone_number, messages in grouped_data.items():
            if phone_number.find("*") != -1:
                phone_number = phone_number.split("*")[1]
            pdf_filename = os.path.join(data_dir, "messages", f"{phone_number}.pdf")
            c = canvas.Canvas(pdf_filename, pagesize=letter)

            # add header with phone number
            c.setFont('Helvetica-Bold', 14)
            c.drawString(50, 750, f"Messages with {phone_number}")

            # add each message in the pdf
            c.setFont('Helvetica', 10)
            y = 700
            for title, datetime, is_for_me, message in messages:
                if is_for_me == 1:
                    c.drawString(50, y, f"sent on {datetime}: {message}")
                elif is_for_me == 0:
                    c.drawString(50, y, f"received on {datetime}: {message}")
                y -= 20
            c.save()

    def export_calendar(self, extracted_data, data_dir):
        # create a new calendar
        cal = Calendar()
        cal.add('prodid', '-//My calendar product//mxm.dk//')
        cal.add('version', '2.0')
        for data in extracted_data:
            summary, dtstart, dtend, description, title = data
            # create new event for each element of extracted_data
            event = Event()
            event.add('summary', f'{summary}')
            event.add('dtstart', datetime(int(dtstart.split("-")[0]),
                                          int(dtstart.split("-")[1]),
                                          int(dtstart.split("-")[2].split(" ")[0]),
                                          int(dtstart.split(":")[0].split(" ")[1]),
                                          int(dtstart.split(":")[1]),
                                          int(dtstart.split(":")[2]), tzinfo=UTC))
            event.add('dtend', datetime(int(dtend.split("-")[0]),
                                        int(dtend.split("-")[1]),
                                        int(dtend.split("-")[2].split(" ")[0]),
                                        int(dtend.split(":")[0].split(" ")[1]),
                                        int(dtend.split(":")[1]),
                                        int(dtend.split(":")[2]), tzinfo=UTC))
            event.add('description', f'{description}')
            event.add('title', f'{title}')
            event.add('priority', 5)
            cal.add_component(event)

        f = open(os.path.join(data_dir, "calendar.ics"), 'wb')
        f.write(cal.to_ical())
        f.close()

    def export_photos(self, photos, data_dir):
        if isinstance(photos, list):
            for file in photos:
                self.export_photos(file, data_dir)

        else:
            if os.path.exists(photos[2]):
                source_file = photos[2]
                os.makedirs(os.path.join(data_dir, "Photos"),
                            exist_ok=True)  # create Photos directory if it doesn't exist
                data_dir = os.path.join(data_dir, "Photos", photos[0])
                shutil.copy2(source_file, data_dir)

    def export_videos(self, videos, data_dir):
        if isinstance(videos, list):
            for file in videos:
                self.export_videos(file, data_dir)

        else:
            if os.path.exists(videos[1]):
                source_file = videos[1]
                os.makedirs(os.path.join(data_dir, "Videos"),
                            exist_ok=True)  # create Photos directory if it doesn't exist
                data_dir = os.path.join(data_dir, "Videos", videos[0])
                shutil.copy2(source_file, data_dir)
# create data manager instance
manager = DataManager()
destination_file_location = r"C:\Users\donal\Downloads\backup samples"
contact = [['Firstname', 'Lastname', 'Organization', 'Department', 'Birthday', 'Jobtitle', 'Note', 'Nickname', 'Creation', 'Modified', 'Phone_work', 'Phone_mobile', 'Phone_home', 'Email', 'Address', 'City'],
         [('Albert Fitzpatrick', None, None, None, None, None, None, None, '2017-02-22 13:56:05', '2017-09-14 15:02:14', None, None, None, None, None, None),
          ("Doctor's Office", None, None, None, None, None, None, None, '2017-02-22 13:55:38', '2017-09-14 15:02:14', None, None, None, None, None, None),
          ('Ginny Weasley', None, None, None, None, None, None, None, '2017-02-22 13:56:20', '2017-09-14 15:02:14', None, None, None, None, None, None),
          ('Jane', 'Appleseed', None, None, None, None, None, None, '2017-02-22 13:09:56', '2017-09-14 15:02:14', None, '0741757524', None, None, None, None),
          ('Principal Howard', None, None, None, None, None, None, None, '2017-02-22 13:56:46', '2017-09-14 15:02:14', None, None, None, None, None, None)]]
# test export contact
manager.export_contacts(contact, destination_file_location)
sms = [(1, '', '2020-07-30 07:37:01', 0, '5602', 'Dekujeme za dobiti Twist karty 737412446. Kredit jsme Vam navysili o 300 Kc. K dobitemu kreditu od nas mate navic jeste bonus 75 Kc a ten plati do 29.08.2020. Kod transakce je 1380353465. Vas T-Mobile'),
       (3, '', '2020-08-05 19:12:07', 0, 't-mobile', 'Dobry den, Vas telefon umi p≈ôijimat a posilat MMS zpravy (videa, obrazky, fotky, delsi texty nez SMS) a je na to spravne nastaveny. Kdyby se ale prece jen objevily problemy, zavolejte na nase Zakaznicke centrum na 4603. Vas T-Mobile\nÔøº'),
       (4, '', '2020-08-06 13:06:47', 0, '4603', 'Dobry den, sve heslo nikomu nesdelujte, at ho nikdo nemuze zneuzit. Vase heslo pro prihlaseni cisla 737412446 do Muj T-Mobile je 339919'),
       (4, '', '2020-08-06 13:11:02', 0, '4603', ' Cislo 721544920 zada o pristup k online vypisu sluzeb cisla 737412446 v apce Muj T-Mobile. Souhlasite-li, predejte heslo 8838. www.tmo.cz/ou '),
       (4, '', '2020-08-15 08:36:13', 1, '4603', 'CeskeLety 03158'),
       (5, '', '2020-08-15 08:36:14', 0, '*info', 'Vazeny zakazniku, litujeme, nerozpoznali jsme Vas pozadavek. Pro pomoc kontaktujte Zakaznicke centrum na cisle 4603, spolecne to jiste vyresime. Vas T-Mobile'),
       (4, '', '2020-08-15 08:38:01', 1, '4603', 'CeskeLeto 03158'),
       (4, '', '2020-08-15 08:38:02', 0, '4603', 'Dobry den, dekujeme, ze s nami objevujete krasy nasi zeme. Pro ziskani odmeny nyni potrebujeme zjistit Vasi polohu. Odpovezte prosim na tuto SMS slovem LETO a my Vam odesleme kod pro aktivaci neomezenych dat zdarma na 24 hodin. A tady www.t-mobile.cz/pomagentove najdete kompletni informace o teto akci a informace ke zpracovani Vasich osobnich udaju. Pokracujte s nami i nadale po magentove. Vas T-Mobile'),
       (4, '', '2020-08-15 08:38:56', 1, '4603', 'LETO'),
       (4, '', '2020-08-15 08:38:58', 0, '4603', 'Gratulujeme! 02852911814668 je Vas kod pro neomezena data zdarma na 24 hodin. Staci ho zadat do aplikace Muj T-Mobile: https://tmcz.page.link/ceskeleto a je to. Pokud apku nemate, uvedeny link Vas dovede na jeji stazeni.  Platnost kodu je 2 dny. A tady www.t-mobile.cz/pomagentove najdete kompletni informace a podminky akce. Pokracujte s nami i nadale po magentove. Vas T-Mobile'),
       (4, '', '2020-08-17 07:55:35', 0, '4603', 'Dobry den, prave jsme Vam zapnuli datovy balicek u cisla 737412446, se kterym surfujete neomezene cely den az do 18.08.2020 09:55 zdarma. To znamena, ze muzete s klidnym srdcem prohanet internet, e-maily nebo treba Facebook a vite, ze nezaplatite nic navic. Prijemne brouzdani, Vas T-Mobile'),
       (4, '', '2020-08-17 13:58:31', 1, '4603', 'CeskeLeto 94080'),
       (4, '', '2020-08-17 13:58:42', 0, '4603', 'Gratulujeme! 07538017631938 je Vas kod pro neomezena data zdarma na 24 hodin. Staci ho zadat do aplikace Muj T-Mobile: https://tmcz.page.link/ceskeleto a je to. Pokud apku nemate, uvedeny link Vas dovede na jeji stazeni.  Platnost kodu je 2 dny. A tady www.t-mobile.cz/pomagentove najdete kompletni informace a podminky akce. Pokracujte s nami i nadale po magentove. Vas T-Mobile'),
       (4, '', '2020-08-18 07:57:48', 0, '4603', 'Dobry den, balicek Neomezeny internet v mobilu na den u cisla 737412446 uz vyprsel. Cerpani dat si muzete kontrolovat v apce Muj T-Mobile, ke stazeni na tmo.cz/mtm. Vas T-Mobile'),
       (4, '', '2020-08-18 08:45:11', 0, '4603', 'Dobry den, prave jsme Vam zapnuli datovy balicek u cisla 737412446, se kterym surfujete neomezene cely den az do 19.08.2020 10:44 zdarma. To znamena, ze muzete s klidnym srdcem prohanet internet, e-maily nebo treba Facebook a vite, ze nezaplatite nic navic. Prijemne brouzdani, Vas T-Mobile'),
       (4, '', '2020-08-18 10:16:47', 1, '4603', 'CESKELETO 30793'), (4, '', '2020-08-18 10:17:01', 0, '4603', 'Gratulujeme! 04442077717981 je Vas kod pro neomezena data zdarma na 24 hodin. Staci ho zadat do aplikace Muj T-Mobile: https://tmcz.page.link/ceskeleto a je to. Pokud apku nemate, uvedeny link Vas dovede na jeji stazeni.  Platnost kodu je 2 dny. A tady www.t-mobile.cz/pomagentove najdete kompletni informace a podminky akce. Pokracujte s nami i nadale po magentove. Vas T-Mobile'),
       (4, '', '2020-08-19 10:40:09', 1, '4603', 'CESKELETO 70808'),
       (4, '', '2020-08-19 10:40:18', 0, '4603', 'Gratulujeme! 05026788229211 je Vas kod pro neomezena data zdarma na 24 hodin. Staci ho zadat do aplikace Muj T-Mobile: https://tmcz.page.link/ceskeleto a je to. Pokud apku nemate, uvedeny link Vas dovede na jeji stazeni.  Platnost kodu je 2 dny. A tady www.t-mobile.cz/pomagentove najdete kompletni informace a podminky akce. Pokracujte s nami i nadale po magentove. Vas T-Mobile'),
       (4, '', '2020-08-19 11:16:13', 0, '4603', 'Dobry den, balicek Neomezeny internet v mobilu na den u cisla 737412446 uz vyprsel. Cerpani dat si muzete kontrolovat v apce Muj T-Mobile, ke stazeni na tmo.cz/mtm. Vas T-Mobile'),
       (4, '', '2020-08-19 12:07:31', 0, '4603', 'Dobry den, prave jsme Vam zapnuli datovy balicek u cisla 737412446, se kterym surfujete neomezene cely den az do 20.08.2020 14:06 zdarma. To znamena, ze muzete s klidnym srdcem prohanet internet, e-maily nebo treba Facebook a vite, ze nezaplatite nic navic. Prijemne brouzdani, Vas T-Mobile'),
       (4, '', '2020-08-20 12:12:33', 0, '4603', 'Dobry den, balicek Neomezeny internet v mobilu na den u cisla 737412446 uz vyprsel. Cerpani dat si muzete kontrolovat v apce Muj T-Mobile, ke stazeni na tmo.cz/mtm. Vas T-Mobile'), (4, '', '2020-08-20 13:35:08', 0, '4603', 'Dobry den, prave jsme Vam zapnuli datovy balicek u cisla 737412446, se kterym surfujete neomezene cely den az do 21.08.2020 15:34 zdarma. To znamena, ze muzete s klidnym srdcem prohanet internet, e-maily nebo treba Facebook a vite, ze nezaplatite nic navic. Prijemne brouzdani, Vas T-Mobile'), (4, '', '2020-08-20 13:36:15', 1, '4603', 'CESKELETO 63885'), (4, '', '2020-08-20 13:36:24', 0, '4603', 'Gratulujeme! 09128808258743 je Vas kod pro neomezena data zdarma na 24 hodin. Staci ho zadat do aplikace Muj T-Mobile: https://tmcz.page.link/ceskeleto a je to. Pokud apku nemate, uvedeny link Vas dovede na jeji stazeni.  Platnost kodu je 2 dny. A tady www.t-mobile.cz/pomagentove najdete kompletni informace a podminky akce. Pokracujte s nami i nadale po magentove. Vas T-Mobile'), (4, '', '2020-08-21 09:33:19', 1, '4603', 'CESKELETO 13193'), (4, '', '2020-08-21 09:33:30', 0, '4603', 'Gratulujeme! 04021753169479 je Vas kod pro neomezena data zdarma na 24 hodin. Staci ho zadat do aplikace Muj T-Mobile: https://tmcz.page.link/ceskeleto a je to. Pokud apku nemate, uvedeny link Vas dovede na jeji stazeni.  Platnost kodu je 2 dny. A tady www.t-mobile.cz/pomagentove najdete kompletni informace a podminky akce. Pokracujte s nami i nadale po magentove. Vas T-Mobile'), (4, '', '2020-08-21 13:46:42', 0, '4603', 'Dobry den, balicek Neomezeny internet v mobilu na den u cisla 737412446 uz vyprsel. Cerpani dat si muzete kontrolovat v apce Muj T-Mobile, ke stazeni na tmo.cz/mtm. Vas T-Mobile'), (4, '', '2020-08-21 14:56:46', 0, '4603', 'Dobry den, prave jsme Vam zapnuli datovy balicek u cisla 737412446, se kterym surfujete neomezene cely den az do 22.08.2020 16:53 zdarma. To znamena, ze muzete s klidnym srdcem prohanet internet, e-maily nebo treba Facebook a vite, ze nezaplatite nic navic. Prijemne brouzdani, Vas T-Mobile'), (6, '', '2020-08-21 16:41:35', 1, '+420602324438', 'Ahoj Dedo uvar nam prosim 2 ovocne caje a 2 earl greye. Jsme u Kladna.'), (4, '', '2020-08-22 14:56:53', 0, '4603', 'Dobry den, balicek Neomezeny internet v mobilu na den u cisla 737412446 uz vyprsel. Cerpani dat si muzete kontrolovat v apce Muj T-Mobile, ke stazeni na tmo.cz/mtm. Vas T-Mobile'), (4, '', '2020-08-25 10:30:18', 0, '4603', '*Dobry den, s neomezenym internetem jste nemuseli resit, jestli Vam dojdou uprostred vyletu data. Aktivujte si nas balicek neomezeneho internetu v mobilu na den za snizenou cenu 69 Kc a uzivejte si nekonecne surfovani jen v ty dny, kdy se Vam to hodi. Zapnete si jej kdykoliv v aplikaci Muj T-Mobile https://tmcz.page.link/SMS nebo poslete NIDEN A na 4603. Uzijte si ceske neomezene leto! Vas T-Mobile. Tyto zpravy muzete odhlasit na 4603.'), (7, '', '2020-08-28 16:25:24', 0, '+420604470072', 'Kristynko, prosim Te, zkontrolujte nahore stresni okna, tady je desnej slejvak...Dekuju!'), (4, '', '2020-08-30 08:02:28', 0, '4603', 'Skoncila platnost vaseho bonusoveho kreditu. Nevycerpany bonusovy kredit ve vysi 0.00 Kc jsme odecetli z vaseho kreditu. Vas aktualni kredit je 275.65 Kc.'), (8, '', '2020-09-05 14:40:03', 0, '+420604470072', 'Ôøº'), (6, '', '2020-09-25 16:28:08', 1, '+420602324438', 'Ahoj Dedo uvar nam prosim 2 ovocne caje a 1 earl greye. Vyjizdime'), (8, '', '2020-09-27 11:59:19', 0, '+420604470072', 'Ôøº'), (9, '', '2020-10-05 12:47:15', 0, '+420721544917', 'Kiki,prijd dolu na svacinu.'), (9, '', '2020-10-13 12:18:12', 1, '+420721544917', 'Dobry den, zveme vas na disciplinu v obyvaku. Karoliny Svetle 239 Stary Plzenec. 14:20. '), (10, '', '2020-10-14 11:03:44', 0, 'www.mzcr.cz', 'Sdeleni MZCR: Prosime nainstalujte si na svuj chytry telefon aplikaci eRouska. Jak funguje a link na instalaci najdete na www.erouska.cz. Aplikace Vas muze upozornit na setkani s COVID nakazenym. Dekuji. Jarmila Razova, hlavni hygienicka CR'), (9, '', '2020-10-16 12:25:06', 1, '+420721544917', 'Jdeme dol≈Ø'), (6, '', '2020-10-24 09:42:59', 1, '+420602324438', 'Ahoj dedo, prave jsme vyjeli. Prijedeme v jednu. Uvar prosim ryzi. '), (4, '', '2020-11-19 12:31:38', 0, '4603', 'Dobry den, radi bychom Vas informovali, ze vzhledem ke zmene legislativy menime od 1. ledna 2021 podminky pro poskytovani sluzby pripojeni k internetu. Novou prilohu c. 1 Ceniku najdete na www.t-mobile.cz a obsahuje napr. nove definovane rychlosti jednotlivych sluzeb. Hezky den, Vas T-Mobile'), (9, '', '2020-11-24 14:40:17', 1, '+420721544917', 'See you later. Bye. '), (4, '', '2020-12-11 11:45:10', 0, '4603', '*Dobry den, v nasi aplikaci https://tmcz.page.link/twistodmena na Vas ceka 10 GB dat. Staci si od ted az do konce roku jakkoliv dobit kredit, vyzvednout si je v aplikaci a surfovat i bez Wi-Fi. Budou zde na Vas cekat vzdy 7 dni po dobiti a budete je mit na 30 dnu. Vice mame na www.t-mobile.cz/twist  Stastne a datove! Vas T-Mobile. Tyto zpravy muzete zrusit na 4603.'), (11, '', '2020-12-14 12:11:58', 1, '+420721544920', 'ƒåek√°m u ≈°koly. Kde jsi? '), (11, '', '2020-12-14 12:12:54', 0, '+420721544920', 'Na zahradƒõ ;)'), (9, '', '2020-12-28 10:35:52', 1, '+420721544917', 'Vƒçera jsme byli na n√°v≈°tƒõvƒõ v ≈òevniƒçovƒõ u tety √Åli, tety Luci a strejdy Michala. Hr√°la jsem si tam s Betinkou (pejskem). Dneska se chyst√°me k Havl≈Øm. '), (12, '', '2021-01-06 12:47:31', 0, '+420734415000', 'Dobr√Ω den, toto je moje nov√© telefonn√≠ ƒç√≠slo. Nat√°lka Mlejnkov√°üôÇ'), (1, '', '2021-01-27 08:03:12', 0, '5602', 'Dobry den, do zitrejsi pulnoci Vam k jednorazovemu dobiti pridame 100 Kc kreditu jako darek! Na vycerpani kreditu mate 30 dni. Vice na www.t-mobile.cz/bon64'), (1, '', '2021-01-28 08:04:41', 0, '5602', 'Dobry den, do zitrejsi pulnoci Vam k jednorazovemu dobiti pridame 100 Kc kreditu jako darek! Na vycerpani kreditu mate 30 dni. Vice na www.t-mobile.cz/bon64'), (1, '', '2021-05-06 06:15:14', 0, '5602', 'Dobry den, do zitrejsi pulnoci Vam k jednorazovemu dobiti pridame 100 Kc kreditu jako darek! Na vycerpani kreditu mate 30 dni. Vice na www.t-mobile.cz/bon64'), (14, '', '2021-06-16 11:32:37', 0, '+420722034690', 'Ahojky'), (14, '', '2021-06-16 11:33:31', 1, '+420722034690', 'Ty nem√°≈° WhatsApp? '), (14, '', '2021-06-16 11:33:44', 0, '+420722034690', 'M√°m'), (14, '', '2021-06-16 11:33:50', 0, '+420722034690', 'A ty'), (14, '', '2021-06-16 11:33:53', 0, '+420722034690', '?'), (14, '', '2021-06-16 11:34:16', 1, '+420722034690', 'Ano. Pi≈°me si pros√≠m p≈ôes nƒõj! '), (14, '', '2021-06-16 11:34:33', 0, '+420722034690', 'Jo a ,, douf√°m ≈æe neru≈°√≠m"'), (14, '', '2021-06-16 11:34:34', 0, '+420722034690', 'Ok'), (6, '', '2021-07-17 10:57:28', 1, '+420602324438', 'Ahoj dƒõdo, vyjeli jsme! M≈Ø≈æe≈° p≈ôipravit Thermomix? Vezeme polotovar. '), (4, '', '2021-07-21 07:23:03', 0, '4603', 'Vitejte v Recku. I tady mate hovory, SMS a MMS za ceny, jako kdyz doma volate nebo pisete na cisla mimo T-Mobile. I internet mate jako doma. Mate zapnutou sluzbu Data roaming limit. Pro volani do CR pouzijte predvolbu +420, napr. Zakaznicke centrum: +420603603603. Volani na zakaznicke centrum a tisnovou linku 112 mate samozrejme zadarmo. Vsechny ceny a podrobnosti najdete na bezplatne strance http://www.tmo.cz/dl. Ale pozor, stranka se Vam otevre, jen pokud nejste na wi-fi. Vas T-Mobile'), (4, '', '2021-07-27 10:59:25', 0, '4603', 'Dobry den, dobijte Vas kredit min. castkou 200Kc do 02/08/2021 09:37, jinak Vam vyprsi lhuta pro dobiti a SIM s Vasim cislem jiz nebudete moci pouzivat. Vysi kreditu si muzete zkontrolovat v apce Muj T-Mobile, ke stazeni na tmo.cz/mtm.'), (11, '', '2021-07-28 12:01:17', 1, '+420721544920', 'ƒåek√°me od z√°vory v pravo!'), (11, '', '2021-07-28 12:50:03', 1, '+420721544920', 'Pos√≠l√° Digital Touch'), (4, '', '2021-07-29 10:20:12', 0, '4603', '*Fandete nasim olympionikum odkudkoliv. Staci si u nas vybrat nektery z mesicnich datovych balicku a my Vam k tomu pridame neomezena data zdarma na cele prazdniny. Poridte si proto treba balicek 800 MB za 109 Kc/30 dni primo v apce: https://tmcz.page.link/APP a zde si pak take aktivujte data bez limitu. Hezke sportovni leto! Vas T-Mobile. Tyto zpravy muzete zrusit na 4603.'), (4, '', '2021-07-31 07:04:24', 0, '4603', 'Dobry den, dobijte Vas kredit min. castkou 200Kc do 02/08/2021 09:37, jinak Vam vyprsi lhuta pro dobiti a SIM s Vasim cislem jiz nebudete moci pouzivat. Vysi kreditu si muzete zkontrolovat v apce Muj T-Mobile, ke stazeni na tmo.cz/mtm.'), (1, '', '2021-07-31 12:15:03', 0, '5602', 'Dekujeme za dobiti Twist karty s cislem 737412446. Kredit jsme Vam navysili o 200 Kc. Kod transakce je 1410554365. Vas T-Mobile'), (8, '', '2021-09-02 08:50:17', 0, '+420604470072', 'Tata uz jede..'), (8, '', '2021-09-05 14:13:25', 0, '+420604470072', 'Ahoj Kiki, jeste se pohadkujete nebo uz jste doma?? My mame prestavku..'), (4, '', '2021-09-25 10:33:41', 0, '4603', 'Dobry den, zapnuli jsme Vam Twist internet na den 100 MB, s nim budete za data platit podle sve spotreby, a to 10 Kc za 100MB denne, tento balicek lze opakovane obnovit. Sve balicky si muzete spravovat v aplikaci Muj T-Mobile: https://tmcz.page.link/SMS. Vas T-Mobile'), (4, '', '2021-09-25 10:33:41', 0, '4603', 'Dobry den, vypnuli jsme Vam Twist internet na den 100 MB, se kterym za data platite podle sve spotreby. Sve balicky si muzete spravovat v aplikaci Muj T-Mobile: https://tmcz.page.link/SMS. Hezky den, Vas T-Mobile'), (15, '', '2021-11-13 20:40:44', 1, '9061113', 'SD 3'), (9, '', '2021-12-27 07:12:59', 1, '+420721544917', 'Ahoj Babi a dƒõdo, \n25. prosince jsme byli na n√°v≈°tƒõvƒõ u Havl≈Ø. Filip slavil 18. narozeniny. \n\nVƒçera jsme byli u ≈†v√°ch≈Ø. \nU nich jsme hr√°li spoleƒçensk√© hry a dƒõlali Star Dance. \n\nA dnes pojedeme do ≈òevniƒçova.\n\nS pozdravem Kiki'), (17, '', '2022-01-07 16:15:18', 0, 'dhl', 'V√°≈° bal√≠ƒçek ƒçek√° na vy≈ô√≠zen√≠. Pros√≠m potvrte oyisat.com/xFVTqqw'), (4, '', '2022-01-13 16:20:02', 0, '4603', '*NABIDKA PRO VAS: Vanocni odmeny za dobiti Vam prodluzujeme az do konce ledna! :-) Pro neomezene volani na cisla znacky T-Mobile a pro 1 GB dat na 30 dni zdarma tak nyni stale staci dobit jen za 250 Kc. Odmenu si pak aktivujte v apce: https://tmcz.page.link/APP do 7 dni od dobiti. Vice mame na www.t-mobile.cz/twist a akce plati do 31.1.2022 Hezky novy rok, Vas T-Mobile. Tyto zpravy muzete zrusit na 4603.'), (18, '', '2022-01-14 23:13:53', 0, '+491638616513', '[MetaMask]: Our system has shown that your MetaMask wallet has not yet been verified. Due to new updates, we ask all our customers to carry out the following verification. This verification can be done easily via the page below: https://s.id/MetaMask. All unverified account will be suspended on January 16th, 2022. Thank you for your understanding.'), (19, '', '2022-02-12 19:57:01', 0, 'tiktok', '[#][TikTok] 225437 is your verification code\nfJpzQvK2eu1'), (20, '', '2022-02-13 14:02:22', 0, '+420607127051', 'Dobry den, mate zmeskane hovory (2) od cisla +420607127051 ze dne 13.02.2022 11:23. T-Mobile. You have missed calls (2) from +420607127051. The last call on 13.02.2022 11:23. T-Mobile.'), (19, '', '2022-02-13 15:38:01', 0, 'tiktok', '[#][TikTok] 448744 is your verification code\nfJpzQvK2eu1'), (4, '', '2022-02-25 11:33:28', 0, '4603', 'Dobry den, od 1.1.2022 jsme zmenili Vseobecne podminky a dalsi podminky, kterymi se ridi poskytovani sluzeb k Vasi predplacene karte (zejm. podminky sjednaneho tarifu, Podminky zpracovani osobnich udaju, podminky preneseni cisla). Podminky v novem zneni budou pro Vas ucinne od 1.4.2022 a jsou jiz nyni k dispozici na www.t-mobile.cz. Od 1.7.2022 mate pravo byt kontaktovan tretimi osobami za ucelem marketingu pouze s predchozim souhlasem uvedenem ve verejnem ucastnickem seznamu. Vice informaci o zmenach najdete na www.t-mobile.cz/novela. Vas T-Mobile'), (4, '', '2022-03-19 09:04:50', 0, '4603', 'Dobry den, vypnuli jsme Vam Twist internet na den 100 MB, se kterym za data platite podle sve spotreby. Sve balicky si muzete spravovat v aplikaci Muj T-Mobile: https://tmcz.page.link/SMS. Hezky den, Vas T-Mobile'), (4, '', '2022-03-19 09:04:51', 0, '4603', 'Dobry den, zapnuli jsme Vam Twist internet na den 100 MB, s nim budete za data platit podle sve spotreby, a to 10 Kc za 100MB denne, tento balicek lze opakovane obnovit. Sve balicky si muzete spravovat v aplikaci Muj T-Mobile: https://tmcz.page.link/SMS. Vas T-Mobile'), (11, '', '2022-03-19 10:00:32', 1, '+420721544920', 'Ahoj, zkou≈°√≠m SMS, jestli funguje. Pr√°vƒõ se budeme l√≠ƒçit. Jsem s Am√°lkou na dece'), (4, '', '2022-04-14 15:06:10', 0, '4603', '*NABIDKA PRO VAS: Uzijte si letosni Velikonoce bez limitu! Mame pro Vas balicek Neomezeny internet v mobilu na den behem svatecnich dnu o 50 % levneji. Ve dnech 15.-18.4. si jej muzete aktivovat jen za 34,50 Kc/den misto beznych 69 Kc/den. Pro aktivaci balicku staci jit do apky: https://tmcz.page.link/APP nebo poslat NIDEN A na 4603. Hezke Velikonoce! Vas T-Mobile. Tyto zpravy zrusite na 4603.'), (4, '', '2022-05-06 13:10:43', 0, '4603', '*NABIDKA PRO VAS: Uzijte si dasi kvetnovy svatecni vikend bez datoveho limitu! Mame pro Vas balicek Neomezeny internet v mobilu na den o 20 % levneji. Ve dnech 7.-8.5. si jej muzete aktivovat jen za 55,20 Kc/den misto beznych 69 Kc/den. Pro aktivaci balicku staci jit do apky: https://tmcz.page.link/APP nebo poslat NIDEN A na 4603. Hezky den, Vas T-Mobile. Tyto zpravy zrusite na 4603.'), (21, '', '2022-05-12 18:15:12', 0, 'whatsapp', 'Vas kod WhatsApp je 639-433\n\nSve cislo muzete overit take klepnutim na odkaz v.whatsapp.com/639433\n\nTento kod s nikym nesdilejte'), (4, '', '2022-06-21 09:00:01', 0, '4603', '*NABIDKA PRO VAS: Kredit navic se bude na prazdniny urcite hodit! Ziskate ho, kdyz si od 15.6. do 31.7. dobijete na nektere T-Mobile prodejne aspon za 300 Kc. K takto prvne dobite castce v danem mesici Vam prihodime 25 % z dobiteho kreditu navic. Tento bonusovy kredit na volani, SMS a data muzete vycerpat do 30 dni od jeho pripsani. Vice si k tomu prectete na www.tmo.cz/op-akce Uzivejte si leto! Vas T-Mobile. Tyto zpravy muzete zrusit na 4603.'), (22, '', '2022-06-24 15:13:28', 0, '+420777816370', 'Chtƒõla si ≈ô√≠ct je≈°tƒõ nƒõco?'), (22, '', '2022-06-24 15:13:49', 1, '+420777816370', '≈Ωe to jede p≈ôes Sedlec'), (22, '', '2022-06-24 15:14:08', 0, '+420777816370', 'Fakt tak co m√°me dƒõlat?'), (22, '', '2022-06-24 15:14:30', 1, '+420777816370', 'ƒåekat, a≈æ p≈ôijedete na komeƒçnou'), (22, '', '2022-06-24 15:14:38', 1, '+420777816370', 'Nevystupujte d≈ô√≠v'), (22, '', '2022-06-24 15:14:50', 1, '+420777816370', 'Kde teƒè jste p≈ôesnƒõ?'), (22, '', '2022-06-24 15:15:06', 0, '+420777816370', 'Na mal√Ω stranƒõ '), (22, '', '2022-06-24 15:15:33', 1, '+420777816370', 'Tak to je≈°tƒõ mus√≠te jet p≈ôes Sedlec a a≈æ na koneƒçn√Ω vystoupit'), (22, '', '2022-06-24 15:15:50', 0, '+420777816370', 'Takjo '), (23, '', '2022-07-06 19:41:36', 1, '+420608499489', '\nMil√Ω Honzo, p√≠≈°u ti tuto zpr√°vu, proto≈æe se u≈æ mo≈æn√° nikdy neuvid√≠me a j√° bych tƒõ moc r√°da je≈°tƒõ nƒõkdy vidƒõla. Chtƒõla bych zaƒç√≠t vypr√°vƒõn√≠m tƒõch spoustu vƒõc√≠, co m√°me spoleƒçn√Ωch, nebo sd√≠let na≈°e spoleƒçn√© vzpom√≠nky. Douf√°m, ≈æe si je pamatuje≈°.  Nechci ti je v≈°echny vyjmenov√°vat, ale nƒõjak√© ti p≈ôipomenu. T≈ôeba to, jak jsme jeli na ≈°koln√≠ v√Ωlet do Techmanie. ≈†li jsme do planet√°ria. Proto≈æe jsme byli je≈°tƒõ mal√≠ (asi tak 1.-2. t≈ô√≠da), chodili jsme po dvojic√≠ch a dr≈æeli se za ruce. Ty ses dr≈æel mƒõ a tuto vzpom√≠nku m√°m v srdci dodnes.\nNen√≠ to jen tahle jedna, m√°m jich v√≠ce.  Pro tebe je to mo≈æn√° jako nic, ale mƒõ potƒõ≈°√≠ i kdy≈æ jen vedle mƒõ stoj√≠≈°. Teƒè se ti chci za nƒõco omluvit. Omlouv√°m se, ≈æe jsem ti psala ty Toxick√© zpr√°vy. Neuvƒõdomila jsem si, ≈æe tƒõ to na≈°tve a zablokuje≈° si mƒõ. U≈æ to nebudu dƒõlat, proto≈æe u≈æ stejnƒõ v√≠≈° o tom tajemstv√≠, kter√© jsem p≈ôed tebou 5 let tajila. Nemus√≠≈° mi nic odepisovat, ale bude mi staƒçit, kdy≈æ si mƒõ odblokuje≈°. J√° budu vƒõdƒõt, ≈æe sis tuto zpr√°vu p≈ôeƒçetl. M≈Ø≈æeme si t≈ôeba ps√°t novinky z gympl≈Ø. Jestli tƒõ zaj√≠maj√≠ ty moje vzpom√≠nky, tak mi m≈Ø≈æe≈° napsat. \n\nS pozdravem Krist√Ωnka Posp√≠≈°ilov√°'), (4, '', '2022-07-12 09:39:16', 0, '4603', '*LETNI NABIDKA PRO VAS: Vite, ze letos o prazdninach rozdavame dva darky? Prvnim jsou Letni data navic zdarma k vyzvednuti v aplikaci Muj T-Mobile pote, co vycerpate data z mesicniho limitu Vaseho balicku. A druhym je vodotesny magentovy vak, ktery za to ceka na prodejne T-Mobile, ale pozor, je jich jen omezene mnozstvi. Vice mame na www.t-mobile.cz/letnidata  Vas T-Mobile. Tyto zpravy muzete zrusit na 4603.'), (4, '', '2022-07-16 13:43:31', 0, '4603', 'Vitejte v Nemecku. I tady mate hovory, SMS a MMS za ceny, jako kdyz doma volate nebo pisete na cisla mimo T-Mobile. I internet mate jako doma. Mate zapnutou sluzbu Data roaming limit. Pro volani do CR pouzijte predvolbu +420, napr. Zakaznicke centrum: +420603603603. Volani na zakaznicke centrum a tisnovou linku 112 mate samozrejme zadarmo. Vsechny ceny a podrobnosti najdete na bezplatne strance http://www.tmo.cz/dl. Ale pozor, stranka se Vam otevre, jen pokud nejste na wi-fi. Vas T-Mobile'), (24, '', '2022-07-25 10:35:22', 0, '4220', 'Dobry den,\n\ndekujeme Vam, ze vyuzivate sluzeb T-Mobile.\n\nRadi bychom se Vas zeptali na nekolik otazek ohledne Vasi zkusenosti s T-Mobile. Kliknutim na odkaz zahajite dotazovani.\n\nhttps://pruzkumy.t-mobile.cz/?e6smrp939d93wkbw8w9pht\n\nPredem dekujeme za Vase odpovedi,\nVas T-Mobile'), (4, '', '2022-07-28 07:18:01', 0, '4603', 'DULEZITE: Dobry den, dobijte si Vas kredit min. castkou 200 Kc do 03/08/2022, jinak Vam vyprsi platnost kreditu a dojde k zablokovani vsech Vasich odchozich sluzeb (volani, odesilani SMS, MMS a vyuziti mobilniho internetu). Vysi kreditu si muzete zkontrolovat v apce Muj T-Mobile, ke stazeni na tmo.cz/mtm. Hezky den, Vas T-Mobile'), (24, '', '2022-07-29 07:45:46', 0, '4220', 'Dobry den,\n\ndekujeme Vam, ze vyuzivate sluzeb T-Mobile.\n\nNedavno jsme Vam zaslali pozvanku k pruzkumu a byli bychom radi, kdybyste nam zodpovedel(a) nekolik otazek ohledne Vasi zkusenosti s T-Mobile. Kliknutim na odkaz zahajite dotazovani.\n\nhttps://pruzkumy.t-mobile.cz/?e6smrp939d93wkbw8w9pht\n\nPredem dekujeme za Vase odpovedi,\nVas T-Mobile'), (4, '', '2022-07-31 06:47:38', 0, '4603', 'Dobry den, nekdo dalsi by rad mel Vase cislo ve sve aplikaci Muj T-Mobile. Souhlasite s tim? Pokud ano, staci mu sdelit tento jednorazovy kod: 854946. Vas T-Mobile'), (4, '', '2022-08-01 11:26:10', 0, '4603', 'DULEZITE: Dobry den, dobijte si Vas kredit min. castkou 200 Kc do 03/08/2022, jinak Vam vyprsi platnost kreditu a dojde k zablokovani vsech Vasich odchozich sluzeb (volani, odesilani SMS, MMS a vyuziti mobilniho internetu). Vysi kreditu si muzete zkontrolovat v apce Muj T-Mobile, ke stazeni na tmo.cz/mtm. Hezky den, Vas T-Mobile'), (1, '', '2022-08-02 19:10:59', 0, '5602', 'POTVRZENI DOBITI: Parada, na Predplacene karte 737412446 jsme prave navysili kredit o 250 Kc. Ted muzete volat, psat a datovat o sto sest. Kod transakce: 1438887592. Hezky den, Vas T-Mobile'), (25, '', '2022-08-29 18:46:11', 0, 'seznam.cz', 'Vas autorizacni kod pro overeni telefonniho cisla je YMWL. Platnost kodu je 5 min. S pozdravem vas Seznam.cz'), (4, '', '2022-09-05 19:00:38', 0, '4603', 'Dobry den, u cisla 737412446 Vam jeste k cerpani zbyva 20 % z Vaseho datoveho limitu. Pro spravne fungovani vsech Vasich aplikaci doporucujeme poridit si vcas dalsi data. Muzete to udelat v aplikaci Muj T-Mobile: https://tmcz.page.link/APP nebo na bezplatne strance: http://tmo.cz/dl. Vas T-Mobile'), (4, '', '2022-09-05 19:03:05', 0, '4603', 'Dobry den, jen Vam chceme dat vedet, ze u cisla 737412446 uz mate prosurfovana vsechna sva data. Cerpani dat si muzete kontrolovat na bezplatne strance http://tmo.cz/dl a v apce Muj T-Mobile, ke stazeni na https://tmcz.page.link/APP. Hezky den, Vas T-Mobile'), (4, '', '2022-09-05 19:12:39', 0, '4603', 'Dobry den, zapnuli jsme Vam Twist internet na den 100 MB, s nim budete za data platit podle sve spotreby, a to 10 Kc za 100MB denne, tento balicek lze opakovane obnovit. Sve balicky si muzete spravovat v aplikaci Muj T-Mobile: https://tmcz.page.link/SMS. Vas T-Mobile'), (4, '', '2022-09-05 19:12:40', 0, '4603', 'Dobry den, vypnuli jsme Vam Twist internet na den 100 MB, se kterym za data platite podle sve spotreby. Sve balicky si muzete spravovat v aplikaci Muj T-Mobile: https://tmcz.page.link/SMS. Hezky den, Vas T-Mobile'), (26, '', '2022-09-27 08:03:15', 0, '+420607966788', 'Ahoj Kristynko, ≈ôekni pros√≠m Elence, ≈æe si doma zapomnƒõla mobil. Poƒç√≠t√°m s t√≠m, ≈æe pojede vlakem. D√≠ky ahoj Hanka Rotov√°'), (4, '', '2022-09-27 12:15:02', 0, '4603', '*NABIDKA PRO VAS: Zavolejte na Vaclava nejen Vaclavum a nesetrete slovy! Staci si 28. 9. 2022 aktivovat balicek neomezeneho Volani do vsech siti na den a ziskate ho jen za 24 Kc/den namisto beznych 30 Kc, tedy o 20 % levneji. Balicek si dany den vyzvednete v apce https://tmcz.page.link/APP nebo aktivujte poslanim VOLANIDEN A na 4603 a uzijte si svatek s volanim bez limitu! Vice na www.t-mobile.cz/densv| Vas T-Mobile. Tyto zpravy zrusite na 4603.'), (9, '', '2022-10-04 10:23:46', 1, '+420721544917', 'Ahoj babi, kdy≈æ pojedete vyzved√°vat Ondru, ≈ôekl v√°m, ≈æe m√°te jet pro n√°s k n√°dra≈æ√≠?'), (9, '', '2022-10-04 10:28:09', 1, '+420721544917', 'My jedeme vlakem a nechceme j√≠t nahoru pƒõ≈°ky'), (27, '', '2022-10-04 10:34:13', 1, '+420721653984', 'Ahoj dƒõdo, je≈°tƒõ tak 10 min'), (27, '', '2022-10-04 10:34:54', 0, '+420721653984', 'Cekam'), (28, '', '2022-10-11 12:14:35', 0, '+420377632675', 'Dobry den, mate zmeskany hovor od cisla +420377632675 ze dne 11.10.2022 14:14.T-Mobile. Missed call notification from +420377632675 11.10.2022 14:14. T-Mobile.'), (27, '', '2022-10-25 10:18:59', 1, '+420721653984', 'Ahoj dƒõdo, ve 12:37 budu na n√°dra≈æ√≠. Jedu jen j√°, Elenka ne'), (27, '', '2022-10-25 10:22:48', 0, '+420721653984', 'Ahoj Krirtynko uz jsem tu.'), (27, '', '2022-10-25 10:37:24', 1, '+420721653984', ' M√° 5 min zpo≈ædƒõn√≠'), (8, '', '2022-10-25 13:01:05', 0, '+420604470072', 'Ahoj Kristynko, tyhle zpravy Ti chodi?'), (8, '', '2022-10-25 15:11:10', 1, '+420604470072', 'Ano, ale za nƒõ se plat√≠'), (8, '', '2022-10-25 15:12:10', 0, '+420604470072', 'Mezi nama s apple mobilem si myslim, ze ne. Si to over u taty. Uz je doma??'), (8, '', '2022-10-25 15:13:22', 1, '+420604470072', 'Nen√≠'), (8, '', '2022-10-25 15:14:37', 1, '+420604470072', 'Z\xa0‚ÄûKristynko, prosim Te, zkontrolujte nahore stresni okna, tady je desnej slejvak...Dekuju!‚Äú byl odstranƒõn vyk≈ôiƒçn√≠k'), (21, '', '2022-10-31 19:15:46', 0, 'whatsapp', 'Prave probiha registrace vaseho uctu WhatsApp na novem zarizeni.\n\nTento kod s nikym nesdilejte.\n\nVas kod WhatsApp je 735-360')]
# test export sms
manager.export_sms(sms, destination_file_location)